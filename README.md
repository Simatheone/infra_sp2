## Проект API YamDB с использованием Docker :ship:

- [Технологии](#tech)
- [Описание проекта](#about-project)
- [Алгоритм регистрации пользователей](#algo-reg)
- [Пользовательские роли](#user-roles)
- [Заполнение .env файла](#fill-env)
- [Запуск проекта](#run-project)
<br>

### <a name="tech">Используемые технологии</a>

Python 3.7 :snake:, Django 2.2.19 :desktop_computer:, Django Rest Framework	3.12.4 :arrows_counterclockwise:, Docker 3.8 :ship:, Nginx :paintbrush:, Postgres :books:
<hr>

### <a name="about-project">Проект YaMDb собирает отзывы пользователей на различные произведения</a>

Проект YaMDb собирает отзывы (***Review***) пользователей на произведения (***Titles***). Произведения делятся на категории: 
- Книги
- Фильмы
- Музыка 
- Искусство и многое другое


Список категорий (***Category***) может быть расширен администратором. Например, можно добавить категорию «Изобразительное искусство» или «Ювелирка».

Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.

В каждой категории есть произведения: книги, фильмы или музыка. Например, в категории «Книги» могут быть произведения «Винни-Пух и все-все-все» и «Марсианские хроники», а в категории «Музыка» — песня «Давеча» группы «Насекомые» и вторая сюита Баха.

Произведению может быть присвоен жанр (***Genre***) из списка предустановленных, например, «Сказка», «Рок» или «Артхаус». Новые жанры может создавать только администратор.

Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы (***Review***) и ставят произведению оценку в диапазоне от одного до десяти. 
Из пользовательских оценок формируется усреднённая оценка произведения — _рейтинг_. На одно произведение пользователь может оставить только один отзыв.
<hr>


### <a name="algo-reg">Алгоритм регистрации пользователей</a>
Пользователь отправляет **POST-запрос** на добавление нового пользователя с параметрами email и username на эндпоинт `/api/v1/auth/signup/`.

YaMDB отправляет письмо с кодом подтверждения (**confirmation_code**) на адрес email.
Пользователь отправляет **POST-запрос** с параметрами username и confirmation_code на эндпоинт `/api/v1/auth/token/`, в ответе на запрос ему приходит Token (JWT-токен).
При желании пользователь отправляет **PATCH-запрос** на эндпоинт `/api/v1/users/me/` и заполняет поля в своём профайле.
<hr>

### <a name="user-roles">Пользовательские роли</a>
**Аноним** — может просматривать описания произведений, читать отзывы и комментарии.

**Аутентифицированный пользователь** (user) — может, как и Аноним, читать всё, дополнительно он может публиковать отзывы и ставить оценку произведениям, может комментировать чужие отзывы. Может редактировать и удалять свои отзывы и комментарии. Эта роль присваивается по умолчанию каждому новому пользователю.

**Модератор** (moderator) — те же права, что и у Аутентифицированного пользователя плюс право удалять любые отзывы и комментарии.

**Администратор** (admin) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.

**Суперюзер Django** — обладет правами администратора (admin).
<hr>

### <a name="fill-env">Заполнение .env файла</a>
В директории `infra_sp2/infra/` создайте **.env** файл и укажите значения для переменных окружения:
- SECRET_KEY
- SERVERNAMES
- DB_ENGINE
- DB_NAME
- POSTGRES_USER
- POSTGRES_PASSWORD
- DB_HOST
- DB_PORT
<hr>

### <a name="run-project">Запуск проекта</a>
Необходимо установить Docker на свою рабочую машину. Инструкцию можно найти на [оффициальном сайте](https://docs.docker.com/get-docker/) по Docker.

После установки Docker необходимо:

1. Клонировать репозиторий:
```bash
git clone https://github.com/Simatheone/api_yamdb.git
```

2. Перейти в директорию `infra_sp2/infra`:
```bash
cd infra_sp2/infra
```

3. В терминали запустить **docker-compose**
```
docker-compose up -d --build
```

По ссылке `http://localhost/redoc` будет доступна документаци к API.
